# VerneMQ Production Configuration
# Optimized for standalone broker with Webhook + File Auth

# Node configuration
distributed_cookie = vmq-cookie
nodename = vernemq@0.0.0.0

# Network Configuration
listener.tcp.default = 0.0.0.0:1883
listener.ws.default = 0.0.0.0:8080
listener.http.metrics = 0.0.0.0:8888

# Authentication & Authorization
allow_anonymous = off
vmq_passwd.password_file = /opt/vernemq/etc/vmq.password
# acl_file = /opt/vernemq/etc/vmq.acl

# Plugins
plugins.vmq_passwd = on
# plugin.vmq_webhooks = on

# Webhooks Configuration (Point to your auth service)
# Example endpoints:
# vmq_webhooks.auth_on_register.endpoint = http://auth-service:5000/mqtt/auth
# vmq_webhooks.auth_on_publish.endpoint = http://auth-service:5000/mqtt/publish
# vmq_webhooks.auth_on_subscribe.endpoint = http://auth-service:5000/mqtt/subscribe

# Logging
log.console = console
log.console.level = info

# Resource Limits
max_connections = 50000
ulimit_open_files = 65536

# TCP Listener Limits
listener.tcp.max_connections = 50000

# Message Queue Limits
max_online_messages = 100000
max_offline_messages = 10000
max_message_size = 268435456

# Connection & Performance Tuning
max_client_id_size = 128
max_topic_levels = 20
max_subscriptions = 100000

# Rate Limiting (disabled for load testing)
# max_message_queue_bytes = unlimited
# max_inflight_messages = 20

# Session Timeout
session_expiry_interval = 86400

# Keepalive Settings
allow_multiple_sessions = off
